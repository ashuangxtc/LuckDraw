# ğŸš€ Vercel éƒ¨ç½²æŒ‡å—

## âœ… å·²å®Œæˆçš„å·¥ä½œ

1. **âœ… Vercel é…ç½®æ–‡ä»¶** - åˆ›å»ºäº† `vercel.json` é…ç½®æ–‡ä»¶
2. **âœ… API è·¯ç”±è¿ç§»** - å°†æ‰€æœ‰ Express è·¯ç”±è¿ç§»åˆ° Vercel Serverless Functions
3. **âœ… å­˜å‚¨å±‚é€‚é…** - ä½¿ç”¨ Vercel KV æ›¿ä»£å†…å­˜å­˜å‚¨
4. **âœ… ç¯å¢ƒé…ç½®** - é…ç½®äº†ç¯å¢ƒå˜é‡å’Œéƒ¨ç½²è®¾ç½®
5. **âœ… å‰ç«¯ API æ›´æ–°** - æ›´æ–°äº†å‰ç«¯ API è°ƒç”¨ä»¥æ”¯æŒ Vercel ç¯å¢ƒ
6. **âœ… æ„å»ºæµ‹è¯•** - éªŒè¯äº†æ„å»ºè¿‡ç¨‹æ­£å¸¸å·¥ä½œ

## ğŸ“ æ–‡ä»¶ç»“æ„

```
â”œâ”€â”€ api/                        # Vercel Serverless Functions
â”‚   â”œâ”€â”€ _lib/                   # å…±äº«å·¥å…·åº“
â”‚   â”‚   â”œâ”€â”€ auth.ts             # ç®¡ç†å‘˜è®¤è¯
â”‚   â”‚   â”œâ”€â”€ storage.ts          # Vercel KV å­˜å‚¨å±‚
â”‚   â”‚   â””â”€â”€ utils.ts            # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ admin/                  # ç®¡ç†å‘˜ API
â”‚   â”‚   â”œâ”€â”€ login.ts            # ç™»å½•
â”‚   â”‚   â”œâ”€â”€ logout.ts           # ç™»å‡º
â”‚   â”‚   â”œâ”€â”€ me.ts               # è·å–çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ participants.ts     # å‚ä¸è€…åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ reset-all.ts        # é‡ç½®æ‰€æœ‰æ•°æ®
â”‚   â”‚   â”œâ”€â”€ reset/[pid].ts      # é‡ç½®å•ä¸ªå‚ä¸è€…
â”‚   â”‚   â””â”€â”€ set-state.ts        # è®¾ç½®æ´»åŠ¨çŠ¶æ€
â”‚   â”œâ”€â”€ lottery/                # æŠ½å¥– API
â”‚   â”‚   â”œâ”€â”€ config.ts           # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ deal.ts             # å‘ç‰Œ
â”‚   â”‚   â”œâ”€â”€ draw.ts             # æŠ½å¥–
â”‚   â”‚   â”œâ”€â”€ join.ts             # åŠ å…¥æŠ½å¥–
â”‚   â”‚   â”œâ”€â”€ pick.ts             # é€‰ç‰Œ
â”‚   â”‚   â””â”€â”€ status.ts           # çŠ¶æ€æŸ¥è¯¢
â”‚   â””â”€â”€ health.ts               # å¥åº·æ£€æŸ¥
â”œâ”€â”€ vercel.json                 # Vercel é…ç½®
â”œâ”€â”€ deploy.sh                   # Linux/Mac éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ deploy.bat                  # Windows éƒ¨ç½²è„šæœ¬
â””â”€â”€ DEPLOYMENT.md               # éƒ¨ç½²è¯´æ˜
```

## ğŸ› ï¸ éƒ¨ç½²æ­¥éª¤

### 1. å®‰è£… Vercel CLI

```bash
npm install -g vercel
```

### 2. ç™»å½• Vercel

```bash
vercel login
```

### 3. åˆ›å»º Vercel KV æ•°æ®åº“

1. è®¿é—® [Vercel æ§åˆ¶å°](https://vercel.com/dashboard)
2. é€‰æ‹©ä½ çš„é¡¹ç›®ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼Œå…ˆåˆ›å»ºä¸€ä¸ªï¼‰
3. è¿›å…¥ "Storage" é€‰é¡¹å¡
4. ç‚¹å‡» "Create Database" 
5. é€‰æ‹© "KV"
6. åˆ›å»ºæ•°æ®åº“å¹¶è®°å½•è¿æ¥ä¿¡æ¯

### 4. è®¾ç½®ç¯å¢ƒå˜é‡

åœ¨ Vercel é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

```
KV_REST_API_URL=your_kv_rest_api_url
KV_REST_API_TOKEN=your_kv_rest_api_token
ADMIN_PASSWORD=Dreammore123
NODE_ENV=production
```

### 5. éƒ¨ç½²

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨éƒ¨ç½²è„šæœ¬

**Windows:**
```cmd
deploy.bat
```

**Linux/Mac:**
```bash
./deploy.sh
```

#### æ–¹å¼äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²

```bash
# æ„å»ºé¡¹ç›®
npm run build

# éƒ¨ç½²åˆ° Vercel
vercel --prod
```

#### æ–¹å¼ä¸‰ï¼šGit è‡ªåŠ¨éƒ¨ç½²

```bash
git add .
git commit -m "Deploy to Vercel"
git push origin main
```

## ğŸ”— API ç«¯ç‚¹

éƒ¨ç½²åï¼Œä»¥ä¸‹ API ç«¯ç‚¹å°†å¯ç”¨ï¼š

### å…¬å…± API
- `GET /api/health` - å¥åº·æ£€æŸ¥
- `POST /api/lottery/join` - åŠ å…¥æŠ½å¥–
- `POST /api/lottery/draw` - æ‰§è¡ŒæŠ½å¥–
- `GET /api/lottery/status` - è·å–æ´»åŠ¨çŠ¶æ€
- `POST /api/lottery/deal` - å‘ç‰Œ
- `POST /api/lottery/pick` - é€‰ç‰Œ
- `GET /api/lottery/config` - è·å–é…ç½®

### ç®¡ç†å‘˜ API
- `POST /api/admin/login` - ç®¡ç†å‘˜ç™»å½•
- `POST /api/admin/logout` - ç®¡ç†å‘˜ç™»å‡º
- `GET /api/admin/me` - è·å–ç®¡ç†å‘˜çŠ¶æ€
- `POST /api/admin/set-state` - è®¾ç½®æ´»åŠ¨çŠ¶æ€
- `GET /api/admin/participants` - è·å–å‚ä¸è€…åˆ—è¡¨
- `POST /api/admin/reset-all` - é‡ç½®æ‰€æœ‰æ•°æ®
- `POST /api/admin/reset/[pid]` - é‡ç½®å•ä¸ªå‚ä¸è€…
- `POST /api/lottery/config` - æ›´æ–°é…ç½®ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰

## ğŸ”§ æŠ€æœ¯æ ˆ

- **å‰ç«¯**: React + TypeScript + Vite
- **åç«¯**: Vercel Serverless Functions
- **å­˜å‚¨**: Vercel KV (Redis)
- **éƒ¨ç½²**: Vercel
- **è®¤è¯**: Cookie-based sessions

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ‰§è¡Œæ—¶é—´é™åˆ¶**: Vercel Serverless Functions æœ‰ 10 ç§’æ‰§è¡Œæ—¶é—´é™åˆ¶
2. **å†…å­˜é™åˆ¶**: é…ç½®ä¸º 1GB å†…å­˜
3. **å¹¶å‘é™åˆ¶**: Vercel KV æœ‰è¯·æ±‚é¢‘ç‡é™åˆ¶
4. **å®‰å…¨æ€§**: ç¡®ä¿åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å¼ºå¯†ç 
5. **CORS**: å·²é…ç½®æ”¯æŒè·¨åŸŸè¯·æ±‚

## ğŸ› æ•…éšœæ’é™¤

### æ„å»ºé”™è¯¯
- ç¡®ä¿æ‰€æœ‰ä¾èµ–éƒ½å·²å®‰è£…ï¼š`npm install`
- æ£€æŸ¥ TypeScript é”™è¯¯ï¼š`npm run check`

### éƒ¨ç½²é”™è¯¯
- æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®è®¾ç½®
- éªŒè¯ Vercel KV æ•°æ®åº“è¿æ¥
- æŸ¥çœ‹ Vercel éƒ¨ç½²æ—¥å¿—

### API é”™è¯¯
- æ£€æŸ¥ `/api/health` ç«¯ç‚¹æ˜¯å¦å“åº”
- éªŒè¯ç®¡ç†å‘˜å¯†ç æ˜¯å¦æ­£ç¡®
- æŸ¥çœ‹æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„ç½‘ç»œè¯·æ±‚

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Vercel éƒ¨ç½²æ—¥å¿—
2. æµè§ˆå™¨å¼€å‘è€…å·¥å…·
3. API å“åº”é”™è¯¯ä¿¡æ¯

## ğŸ‰ éƒ¨ç½²æˆåŠŸå

1. è®¿é—®ä½ çš„ Vercel åŸŸå
2. æµ‹è¯•æŠ½å¥–åŠŸèƒ½
3. ä½¿ç”¨ç®¡ç†å‘˜å¯†ç ç™»å½•åå°
4. éªŒè¯æ‰€æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ

æ­å–œï¼ä½ çš„éº»å°†æŠ½å¥–åº”ç”¨å·²æˆåŠŸéƒ¨ç½²åˆ° Vercelï¼ğŸŠ
